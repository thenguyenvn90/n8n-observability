# === USER SETTINGS ===
DOMAIN=domain.com
SUBDOMAIN_N8N=n8n
SUBDOMAIN_GRAFANA=grafana
SUBDOMAIN_PROMETHEUS=prometheus
SSL_EMAIL=you@example.com
GENERIC_TIMEZONE=Asia/Ho_Chi_Minh

# === SECRETS (USE STRONG VALUES!) ===
STRONG_PASSWORD=CHANGE_ME_BASE64_16_BYTES
N8N_ENCRYPTION_KEY=CHANGE_ME_BASE64_32_BYTES
RUNNERS_AUTH_TOKEN=CHANGE_ME_BASE64_16_BYTES

# === N8N GENERAL CONFIG ===
N8N_IMAGE_TAG=latest
NODE_ENV=production
N8N_LOG_LEVEL=info
N8N_DIAGNOSTICS_ENABLED=false

# Security (UI login)
N8N_BASIC_AUTH_ACTIVE=true
N8N_BASIC_AUTH_USER=admin
N8N_BASIC_AUTH_PASSWORD=${STRONG_PASSWORD}

# File permission hardening
N8N_ENFORCE_SETTINGS_FILE_PERMISSIONS=true

# === DATABASE (Postgres) ===
DB_TYPE=postgresdb
DB_POSTGRESDB_HOST=postgres
DB_POSTGRESDB_PORT=5432
DB_POSTGRESDB_DATABASE=n8n
DB_POSTGRESDB_USER=n8n
DB_POSTGRESDB_PASSWORD=${STRONG_PASSWORD}

# For the PostgreSQL container itself
POSTGRES_USER=n8n
POSTGRES_PASSWORD=${STRONG_PASSWORD}
POSTGRES_DB=n8n

# === QUEUE MODE ===
EXECUTIONS_MODE=queue
# Redis (BullMQ queue)
QUEUE_BULL_REDIS_HOST=redis
QUEUE_BULL_REDIS_PORT=6379
QUEUE_BULL_REDIS_PASSWORD=${STRONG_PASSWORD}
N8N_DISABLE_PRODUCTION_MAIN_PROCESS=true

# Workers
N8N_WORKER_CONCURRENCY=5

# Binary data storage
N8N_DEFAULT_BINARY_DATA_MODE=default

# === EXECUTION BEHAVIOR ===
EXECUTIONS_TIMEOUT=3600
EXECUTIONS_DATA_PRUNE=true
EXECUTIONS_DATA_MAX_AGE=336
EXECUTIONS_RETRY_MAX=3

# === OPTIONAL / ADVANCED ===
OFFLOAD_MANUAL_EXECUTIONS_TO_WORKERS=true
QUEUE_HEALTH_CHECK_ACTIVE=true

# === EXTERNAL TASK RUNNER ===
N8N_RUNNERS_ENABLED=true
N8N_RUNNERS_MODE=external
N8N_RUNNERS_BROKER_LISTEN_ADDRESS=0.0.0.0
N8N_RUNNERS_MAX_CONCURRENCY=5
N8N_RUNNERS_AUTH_TOKEN=${RUNNERS_AUTH_TOKEN}

# === Traefik Basic Auth for Grafana/Prometheus routes (bcrypt hash; escape $ as $$) ===
# Example: admin:$$2y$$05$$REPLACE_WITH_BCRYPT_HASH
TRAEFIK_BASIC_AUTH_USERS=admin:$$2y$$REPLACE_WITH_BCRYPT_HASH
